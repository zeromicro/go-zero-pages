
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Middle Ground System Â· go-zero document</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="anqiansong">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-flexible-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="stream.html" />
    
    
    <link rel="prev" href="go-queue.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="about-us.html">
            
                <a href="about-us.html">
            
                    
                    About Us
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="join-us.html">
            
                <a href="join-us.html">
            
                    
                    Join Us
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="concept-introduction.html">
            
                <a href="concept-introduction.html">
            
                    
                    Concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="quick-start.html">
            
                <a href="quick-start.html">
            
                    
                    Quick Start
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="monolithic-service.html">
            
                <a href="monolithic-service.html">
            
                    
                    Monolithic Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="micro-service.html">
            
                <a href="micro-service.html">
            
                    
                    Micro Service
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="framework-design.html">
            
                <a href="framework-design.html">
            
                    
                    Framework Design
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="go-zero-design.html">
            
                <a href="go-zero-design.html">
            
                    
                    Go-Zero Design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="go-zero-features.html">
            
                <a href="go-zero-features.html">
            
                    
                    Go-Zero Features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="api-grammar.html">
            
                <a href="api-grammar.html">
            
                    
                    API IDL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="api-dir.html">
            
                <a href="api-dir.html">
            
                    
                    API Directory Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="rpc-dir.html">
            
                <a href="rpc-dir.html">
            
                    
                    RPC Directory Structure
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="project-dev.html">
            
                <a href="project-dev.html">
            
                    
                    Project Development
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="prepare.html">
            
                <a href="prepare.html">
            
                    
                    Prepare
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1.1" data-path="golang-install.html">
            
                <a href="golang-install.html">
            
                    
                    Golang Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.2" data-path="gomod-config.html">
            
                <a href="gomod-config.html">
            
                    
                    Go Module Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.3" data-path="goctl-install.html">
            
                <a href="goctl-install.html">
            
                    
                    Goctl Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.4" data-path="protoc-install.html">
            
                <a href="protoc-install.html">
            
                    
                    protoc & protoc-gen-go Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.5" data-path="prepare-other.html">
            
                <a href="prepare-other.html">
            
                    
                    More
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="dev-specification.html">
            
                <a href="dev-specification.html">
            
                    
                    Development Rules
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.2.1" data-path="naming-spec.html">
            
                <a href="naming-spec.html">
            
                    
                    Naming Rules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.2" data-path="route-naming-spec.html">
            
                <a href="route-naming-spec.html">
            
                    
                    Route Rules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.3" data-path="coding-spec.html">
            
                <a href="coding-spec.html">
            
                    
                    Coding Rules
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="dev-flow.html">
            
                <a href="dev-flow.html">
            
                    
                    Development Flow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="config-introduction.html">
            
                <a href="config-introduction.html">
            
                    
                    Configuration Introduction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.4.1" data-path="api-config.html">
            
                <a href="api-config.html">
            
                    
                    API Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4.2" data-path="rpc-config.html">
            
                <a href="rpc-config.html">
            
                    
                    RPC Configuration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="business-dev.html">
            
                <a href="business-dev.html">
            
                    
                    Business Development
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.5.1" data-path="service-design.html">
            
                <a href="service-design.html">
            
                    
                    Directory Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.2" data-path="model-gen.html">
            
                <a href="model-gen.html">
            
                    
                    Model Generation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.3" data-path="api-coding.html">
            
                <a href="api-coding.html">
            
                    
                    API Coding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.4" data-path="business-coding.html">
            
                <a href="business-coding.html">
            
                    
                    Business Coding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.5" data-path="jwt.html">
            
                <a href="jwt.html">
            
                    
                    JWT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.6" data-path="middleware.html">
            
                <a href="middleware.html">
            
                    
                    Middleware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.7" data-path="rpc-call.html">
            
                <a href="rpc-call.html">
            
                    
                    RPC Implement & Call
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.8" data-path="error-handle.html">
            
                <a href="error-handle.html">
            
                    
                    Error Handling
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="ci-cd.html">
            
                <a href="ci-cd.html">
            
                    
                    CI/CD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="service-deployment.html">
            
                <a href="service-deployment.html">
            
                    
                    Service Deployment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="log-collection.html">
            
                <a href="log-collection.html">
            
                    
                    Log Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="trace.html">
            
                <a href="trace.html">
            
                    
                    Trace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="service-monitor.html">
            
                <a href="service-monitor.html">
            
                    
                    Monitor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="goctl.html">
            
                <a href="goctl.html">
            
                    
                    Goctl
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="goctl-commands.html">
            
                <a href="goctl-commands.html">
            
                    
                    Commands & Flags
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="goctl-api.html">
            
                <a href="goctl-api.html">
            
                    
                    API Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="goctl-rpc.html">
            
                <a href="goctl-rpc.html">
            
                    
                    RPC Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="goctl-model.html">
            
                <a href="goctl-model.html">
            
                    
                    Model Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="goctl-plugin.html">
            
                <a href="goctl-plugin.html">
            
                    
                    Plugin Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="goctl-other.html">
            
                <a href="goctl-other.html">
            
                    
                    More Commands
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="component-center.html">
            
                <a href="component-center.html">
            
                    
                    Components
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="logx.html">
            
                <a href="logx.html">
            
                    
                    logx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="bloom.html">
            
                <a href="bloom.html">
            
                    
                    bloom
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="executors.html">
            
                <a href="executors.html">
            
                    
                    executors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="fx.html">
            
                <a href="fx.html">
            
                    
                    fx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="mysql.html">
            
                <a href="mysql.html">
            
                    
                    mysql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="redis-lock.html">
            
                <a href="redis-lock.html">
            
                    
                    redis-lock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="periodlimit.html">
            
                <a href="periodlimit.html">
            
                    
                    periodlimit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="tokenlimit.html">
            
                <a href="tokenlimit.html">
            
                    
                    tokenlimit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="timing-wheel.html">
            
                <a href="timing-wheel.html">
            
                    
                    TimingWheel
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="tool-center.html">
            
                <a href="tool-center.html">
            
                    
                    Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="intellij.html">
            
                <a href="intellij.html">
            
                    
                    Intellij Plugin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="vscode.html">
            
                <a href="vscode.html">
            
                    
                    VSCode Plugin
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="plugin-center.html">
            
                <a href="plugin-center.html">
            
                    
                    Plugins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="learning-resource.html">
            
                <a href="learning-resource.html">
            
                    
                    Learning Resources
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="wechat.html">
            
                <a href="wechat.html">
            
                    
                    Wechat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="goreading.html">
            
                <a href="goreading.html">
            
                    
                    Night
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="gotalk.html">
            
                <a href="gotalk.html">
            
                    
                    OpenTalk
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="practise.html">
            
                <a href="practise.html">
            
                    
                    User Practise
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="redis-cache.html">
            
                <a href="redis-cache.html">
            
                    
                    Persistent layer cache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="buiness-cache.html">
            
                <a href="buiness-cache.html">
            
                    
                    Business layer cache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="go-queue.html">
            
                <a href="go-queue.html">
            
                    
                    Queue
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.13.4" data-path="datacenter.html">
            
                <a href="datacenter.html">
            
                    
                    Middle Ground System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.5" data-path="stream.html">
            
                <a href="stream.html">
            
                    
                    Stream Handler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.6" data-path="online-exchange.html">
            
                <a href="online-exchange.html">
            
                    
                    Online Exchange
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="contributor.html">
            
                <a href="contributor.html">
            
                    
                    Contributor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="doc-contibute.html">
            
                <a href="doc-contibute.html">
            
                    
                    Document Contribute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="error.html">
            
                <a href="error.html">
            
                    
                    Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="source.html">
            
                <a href="source.html">
            
                    
                    Source Code
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Middle Ground System</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="how-do-i-use-go-zero-to-implement-a-middle-ground-system">How do I use go-zero to implement a Middle Ground System?</h1>
<blockquote>
<p>[!TIP]
This document is machine-translated by Google. If you find grammatical and semantic errors, and the document description is not clear, please <a href="doc-contibute.html">PR</a></p>
<p>Author: Jack Luo</p>
<p>Original link&#xFF1A;<a href="https://www.cnblogs.com/jackluo/p/14148518.html" target="_blank">https://www.cnblogs.com/jackluo/p/14148518.html</a></p>
</blockquote>
<p>[TOC]</p>
<p>I recently discovered that a new star microservice framework has emerged in the golang community. 
It comes from a good future. Just looking at the name, it is very exciting. Before, I only played go-micro. 
In fact, I have not used it in the project. I think that microservices and grpc are very noble. 
They have not been in the project yet. I have really played them. I saw that the tools provided by the government are really easy to use. 
They only need to be defined, and the comfortable file structure is generated. I am concerned about business, and there was a voting activity recently, 
and in recent years, Middle Ground System have been quite popular, so I decided to give it a try.</p>
<blockquote>
<p>SourceCode: <a href="https://github.com/jackluo2012/datacenter" target="_blank">https://github.com/jackluo2012/datacenter</a></p>
</blockquote>
<p>Let&apos;s talk about the idea of Middle Ground System architecture first&#xFF1A;</p>
<p><img src="https://img2020.cnblogs.com/blog/203395/202012/203395-20201217094615171-335437652.jpg" alt=""></p>
<p>The concept of Middle Ground System is probably to unify the apps one by one. I understand it this way anyway.</p>
<p>Let&#x2019;s talk about user service first. Now a company has a lot of official accounts, small programs, WeChat, Alipay, and xxx xxx, and a lot of platforms. Every time we develop, we always need to provide user login services. Stop copying the code, and then we are thinking about whether we can have a set of independent user services, just tell me you need to send a platform you want to log in (such as WeChat), WeChat login, what is needed is that the client returns one to the server code, and then the server takes this code to WeChat to get user information. Anyway, everyone understands it.</p>
<p>We decided to get all the information into the configuration public service, and then store the appid and appkey of WeChat, Alipay and other platforms, as well as the appid and appkey of payment, and write a set.</p>
<hr>
<p>Finally, let&apos;s talk about implementation, the whole is a repo:</p>
<ul>
<li>Gateway, we use: go-zero&apos;s Api service</li>
<li>Others are services, we use go-zero rpc service</li>
</ul>
<p>Look at the directory structure</p>
<p><img src="https://img2020.cnblogs.com/blog/203395/202012/203395-20201209110504600-317546535.png" alt=""></p>
<p>After the whole project was completed, I worked alone and wrote about it for a week, and then I realized the above Middle Ground System.</p>
<h2 id="datacenter-api-service">datacenter-api service</h2>
<p>Look at the official document first <a href="https://zeromicro.github.io/go-zero/" target="_blank">https://zeromicro.github.io/go-zero/</a></p>
<p>Let&apos;s set up the gateway first:&#xFF1A;</p>
<pre class="language-"><code class="lang-shell">&#x279C; blogs <span class="token function">mkdir</span> datacenter <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> datacenter
&#x279C; datacenter go mod init datacenter
go: creating new go.mod: module datacenter
&#x279C; datacenter
</code></pre>
<p>View the book directory:</p>
<pre class="language-"><code>&#x279C;  datacenter tree
.
&#x2514;&#x2500;&#x2500; go.mod

0 directories, 1 file
</code></pre><h3 id="create-api-file">Create api file</h3>
<pre class="language-"><code>&#x279C;  datacenter goctl api -o datacenter.api
Done.
&#x279C;  datacenter tree
.
&#x251C;&#x2500;&#x2500; datacenter.api
&#x2514;&#x2500;&#x2500; go.mod
</code></pre><h3 id="define-api-service">Define api service</h3>
<p>Respectively include the above <strong>Public Service</strong>, <strong>User Service</strong>, <strong>Voting Activity Service</strong></p>
<pre class="language-"><code>info(
    title: &quot;demo&quot;
    desc: &quot;demo&quot;
    author: &quot;jackluo&quot;
    email: &quot;net.webjoy@gmail.com&quot;
)

// Get application information
type Beid struct {
    Beid int64 `json:&quot;beid&quot;`
}
type Token struct{
    Token string `json:&quot;token&quot;`
}
type WxTicket struct{
    Ticket string `json:&quot;ticket&quot;`
}
type Application struct {
    Sname string `json:&quot;Sname&quot;`
    Logo string `json:&quot;logo&quot;`
    Isclose int64 `json:&quot;isclose&quot;`
    Fullwebsite string `json:&quot;fullwebsite&quot;`
}
type SnsReq struct{
    Beid
    Ptyid int64  `json:&quot;ptyid&quot;` // Platform ID
    BackUrl string `json:&quot;back_url&quot;` // Return address after login
}
type SnsResp struct{
    Beid
    Ptyid int64  `json:&quot;ptyid&quot;` // Platform ID
    Appid string  `json:&quot;appid&quot;` // sns Platform ID
    Title string  `json:&quot;title&quot;`
    LoginUrl string `json:&quot;login_url&quot;` // WeChat login address
}

type WxShareResp struct {
    Appid string `json:&quot;appid&quot;`
    Timestamp int64 `json:&quot;timestamp&quot;`
    Noncestr string `json:&quot;noncestr&quot;`
    Signature string `json:&quot;signature&quot;`
}

@server(
    group: common
)
service datacenter-api {
    @doc(
        summary: &quot;Get information about the site&quot;
    )
    @handler votesVerification
    get /MP_verify_NT04cqknJe0em3mT.txt (SnsReq) returns (SnsResp)

    @handler appInfo
    get /common/appinfo (Beid) returns (Application)

    @doc(
        summary: &quot;Get social attribute information of the site&quot;
    )
    @handler snsInfo
    post /common/snsinfo (SnsReq) returns (SnsResp)
    // Get shared returns
    @handler wxTicket
    post /common/wx/ticket (SnsReq) returns (WxShareResp)

}

@server(
    jwt: Auth
    group: common
)
service datacenter-api {
    @doc(
        summary: &quot;Qiniu upload credentials&quot;
    )
    @handler qiuniuToken
    post /common/qiuniu/token (Beid) returns (Token)
}

// Registration request
type RegisterReq struct {
    Mobile   string `json:&quot;mobile&quot;` 
    Password string `json:&quot;password&quot;`
    Smscode    string `json:&quot;smscode&quot;`
}
// Login request
type LoginReq struct{
    Mobile   string `json:&quot;mobile&quot;`
    Type int64 `json:&quot;type&quot;`    // 1. Password login, 2. SMS login
    Password string `json:&quot;password&quot;`
}
// WeChat login
type WxLoginReq struct {
    Beid      int64  `json:&quot;beid&quot;` // Application id
    Code string `json:&quot;code&quot;` // WeChat AccesskKey
    Ptyid      int64  `json:&quot;ptyid&quot;` // Platform ID
}

//Return user information
type UserReply struct {
    Auid       int64  `json:&quot;auid&quot;`
    Uid       int64  `json:&quot;uid&quot;`
    Beid      int64  `json:&quot;beid&quot;` // Platform ID
    Ptyid      int64  `json:&quot;ptyid&quot;`
    Username string `json:&quot;username&quot;`
    Mobile   string `json:&quot;mobile&quot;`
    Nickname string `json:&quot;nickname&quot;`
    Openid string `json:&quot;openid&quot;`
    Avator string `json:&quot;avator&quot;`
    JwtToken
}

type AppUser struct{
    Uid       int64  `json:&quot;uid&quot;`
    Auid       int64  `json:&quot;auid&quot;`
    Beid      int64  `json:&quot;beid&quot;`
    Ptyid      int64  `json:&quot;ptyid&quot;`
    Nickname string `json:&quot;nickname&quot;`
    Openid string `json:&quot;openid&quot;`
    Avator string `json:&quot;avator&quot;`
}

type LoginAppUser struct{
    Uid       int64  `json:&quot;uid&quot;`
    Auid       int64  `json:&quot;auid&quot;`
    Beid      int64  `json:&quot;beid&quot;`
    Ptyid      int64  `json:&quot;ptyid&quot;`
    Nickname string `json:&quot;nickname&quot;`
    Openid string `json:&quot;openid&quot;`
    Avator string `json:&quot;avator&quot;`
    JwtToken
}

type JwtToken struct {
    AccessToken  string `json:&quot;access_token,omitempty&quot;`
    AccessExpire int64  `json:&quot;access_expire,omitempty&quot;`
    RefreshAfter int64  `json:&quot;refresh_after,omitempty&quot;`
}

type UserReq struct{
    Auid       int64  `json:&quot;auid&quot;`
    Uid       int64  `json:&quot;uid&quot;`
    Beid      int64  `json:&quot;beid&quot;`
    Ptyid      int64  `json:&quot;ptyid&quot;`
}

type Request {
    Name string `path:&quot;name,options=you|me&quot;`
}
type Response {
    Message string `json:&quot;message&quot;`
}

@server(
    group: user
)
service user-api {
    @handler ping
    post /user/ping ()

    @handler register
    post /user/register (RegisterReq) returns (UserReply)

    @handler login
    post /user/login (LoginReq) returns (UserReply)

    @handler wxlogin
    post /user/wx/login (WxLoginReq) returns (LoginAppUser)

    @handler code2Session
    get /user/wx/login () returns (LoginAppUser)
}
@server(
    jwt: Auth
    group: user
    middleware: Usercheck
)
service user-api {
    @handler userInfo
    get /user/dc/info (UserReq) returns (UserReply)
}


type Actid struct {
    Actid       int64  `json:&quot;actid&quot;`
}

type VoteReq struct {
    Aeid       int64  `json:&quot;aeid&quot;`
    Actid
}
type VoteResp struct {
    VoteReq
    Votecount       int64  `json:&quot;votecount&quot;`
    Viewcount       int64  `json:&quot;viewcount&quot;`
}


type ActivityResp struct {
    Actid           int64  `json:&quot;actid&quot;`
    Title           string  `json:&quot;title&quot;` 
    Descr           string  `json:&quot;descr&quot;` 
    StartDate       int64  `json:&quot;start_date&quot;` 
    EnrollDate      int64  `json:&quot;enroll_date&quot;` 
    EndDate           int64  `json:&quot;end_date&quot;` 
    Votecount       int64  `json:&quot;votecount&quot;`
    Viewcount       int64  `json:&quot;viewcount&quot;`
    Type            int64 `json:&quot;type&quot;`
    Num                int64 `json:&quot;num&quot;`
}

type EnrollReq struct {
    Actid
    Name           string  `json:&quot;name&quot;`
    Address           string  `json:&quot;address&quot;`
    Images           []string  `json:&quot;images&quot;`
    Descr           string  `json:&quot;descr&quot;`
}

type EnrollResp struct {
    Actid
    Aeid        int64 `json:&quot;aeid&quot;` 
    Name           string  `json:&quot;name&quot;`
    Address           string  `json:&quot;address&quot;`
    Images           []string  `json:&quot;images&quot;`
    Descr           string  `json:&quot;descr&quot;`
    Votecount       int64  `json:&quot;votecount&quot;`
    Viewcount       int64  `json:&quot;viewcount&quot;`

}

@server(
    group: votes
)
service votes-api {
    @doc(
        summary: &quot;Get activity information&quot;
    )
    @handler activityInfo
    get /votes/activity/info (Actid) returns (ActivityResp)
    @doc(
        summary: &quot;Activity visit +1&quot;
    )
    @handler activityIcrView
    get /votes/activity/view (Actid) returns (ActivityResp)
    @doc(
        summary: &quot;Get information about registered voting works&quot;
    )
    @handler enrollInfo
    get /votes/enroll/info (VoteReq) returns (EnrollResp)
    @doc(
        summary: &quot;Get a list of registered works&quot;
    )
    @handler enrollLists
    get /votes/enroll/lists (Actid)    returns(EnrollResp)
}

@server(
    jwt: Auth
    group: votes
    middleware: Usercheck
)
service votes-api {
    @doc(
        summary: &quot;vote&quot;
    )
    @handler vote
    post /votes/vote (VoteReq) returns (VoteResp)
    @handler enroll
    post /votes/enroll (EnrollReq) returns (EnrollResp)
}
</code></pre><p>The API and document ideas that are basically written above</p>
<h3 id="generate-datacenter-api-service">Generate datacenter api service</h3>
<pre class="language-"><code>&#x279C;  datacenter goctl api go -api datacenter.api -dir .
Done.
&#x279C;  datacenter tree
.
&#x251C;&#x2500;&#x2500; datacenter.api
&#x251C;&#x2500;&#x2500; etc
&#x2502;   &#x2514;&#x2500;&#x2500; datacenter-api.yaml
&#x251C;&#x2500;&#x2500; go.mod
&#x251C;&#x2500;&#x2500; internal
&#x2502;   &#x251C;&#x2500;&#x2500; config
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; config.go
&#x2502;   &#x251C;&#x2500;&#x2500; handler
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; common
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; appinfohandler.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; qiuniutokenhandler.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; snsinfohandler.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; votesverificationhandler.go
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; wxtickethandler.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; routes.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; user
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; code2sessionhandler.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; loginhandler.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; pinghandler.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; registerhandler.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; userinfohandler.go
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; wxloginhandler.go
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; votes
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; activityicrviewhandler.go
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; activityinfohandler.go
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; enrollhandler.go
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; enrollinfohandler.go
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; enrolllistshandler.go
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; votehandler.go
&#x2502;   &#x251C;&#x2500;&#x2500; logic
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; common
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; appinfologic.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; qiuniutokenlogic.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; snsinfologic.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; votesverificationlogic.go
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; wxticketlogic.go
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; user
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; code2sessionlogic.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; loginlogic.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; pinglogic.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; registerlogic.go
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; userinfologic.go
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; wxloginlogic.go
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; votes
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; activityicrviewlogic.go
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; activityinfologic.go
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; enrollinfologic.go
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; enrolllistslogic.go
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; enrolllogic.go
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; votelogic.go
&#x2502;   &#x251C;&#x2500;&#x2500; middleware
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; usercheckmiddleware.go
&#x2502;   &#x251C;&#x2500;&#x2500; svc
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; servicecontext.go
&#x2502;   &#x2514;&#x2500;&#x2500; types
&#x2502;       &#x2514;&#x2500;&#x2500; types.go
&#x2514;&#x2500;&#x2500; datacenter.go

14 directories, 43 files
</code></pre><p>We open <code>etc/datacenter-api.yaml</code> and add the necessary configuration information</p>
<pre class="language-"><code class="lang-yaml"><span class="token key atrule">Name</span><span class="token punctuation">:</span> datacenter<span class="token punctuation">-</span>api
<span class="token key atrule">Log</span><span class="token punctuation">:</span>
  <span class="token key atrule">Mode</span><span class="token punctuation">:</span> console
<span class="token key atrule">Host</span><span class="token punctuation">:</span> 0.0.0.0
<span class="token key atrule">Port</span><span class="token punctuation">:</span> <span class="token number">8857</span>
<span class="token key atrule">Auth</span><span class="token punctuation">:</span>
  <span class="token key atrule">AccessSecret</span><span class="token punctuation">:</span> secret
  <span class="token key atrule">AccessExpire</span><span class="token punctuation">:</span> <span class="token number">86400</span>
<span class="token key atrule">CacheRedis</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">Host</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">6379</span>
  <span class="token key atrule">Pass</span><span class="token punctuation">:</span> pass
  <span class="token key atrule">Type</span><span class="token punctuation">:</span> node                     
<span class="token key atrule">UserRpc</span><span class="token punctuation">:</span>
  <span class="token key atrule">Etcd</span><span class="token punctuation">:</span>
    <span class="token key atrule">Hosts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">2379</span>
    <span class="token key atrule">Key</span><span class="token punctuation">:</span> user.rpc
<span class="token key atrule">CommonRpc</span><span class="token punctuation">:</span>
  <span class="token key atrule">Etcd</span><span class="token punctuation">:</span>
    <span class="token key atrule">Hosts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">2379</span>
    <span class="token key atrule">Key</span><span class="token punctuation">:</span> common.rpc
<span class="token key atrule">VotesRpc</span><span class="token punctuation">:</span>
  <span class="token key atrule">Etcd</span><span class="token punctuation">:</span>
    <span class="token key atrule">Hosts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">2379</span>
    <span class="token key atrule">Key</span><span class="token punctuation">:</span> votes.rpc
</code></pre>
<p>I will write the above <code>UserRpc</code>, <code>CommonRpc</code>, and <code>VotesRpc</code> first, and then add them by step.</p>
<p>Let&apos;s write the <code>CommonRpc</code> service first.</p>
<h2 id="commonrpc-service">CommonRpc service</h2>
<h3 id="new-project-directory">New project directory</h3>
<pre class="language-"><code>&#x279C;  datacenter mkdir -p common/rpc &amp;&amp; cd common/rpc
</code></pre><p>Just create it directly in the datacenter directory, because in common, it may not only provide rpc services in the future, but also api services, so the rpc directory is added</p>
<h3 id="goctl-create-template">goctl create template</h3>
<pre class="language-"><code>&#x279C;  rpc goctl rpc template -o=common.proto
&#x279C;  rpc ls
common.proto
</code></pre><p>Fill in the content&#xFF1A;</p>
<pre class="language-"><code class="lang-protobufbuf">&#x279C;  rpc cat common.proto
syntax = &quot;proto3&quot;;

package common;


message BaseAppReq{
  int64 beid=1;
}

message BaseAppResp{
  int64 beid=1;
  string logo=2;
  string sname=3;
  int64 isclose=4;
  string fullwebsite=5;
}

message AppConfigReq {
  int64 beid=1;
  int64 ptyid=2;
}

message AppConfigResp {
  int64 id=1;
  int64 beid=2;
  int64 ptyid=3;
  string appid=4;
  string appsecret=5;
  string title=6;
}

service Common {
  rpc GetAppConfig(AppConfigReq) returns(AppConfigResp);
  rpc GetBaseApp(BaseAppReq) returns(BaseAppResp);
}
</code></pre>
<h3 id="gotcl-generates-rpc-service">gotcl generates rpc service</h3>
<pre class="language-"><code class="lang-bash">&#x279C;  rpc goctl rpc proto -src common.proto -dir <span class="token builtin class-name">.</span>
protoc  -I<span class="token operator">=</span>/Users/jackluo/works/blogs/datacenter/common/rpc common.proto --go_out<span class="token operator">=</span>plugins<span class="token operator">=</span>grpc:/Users/jackluo/works/blogs/datacenter/common/rpc/common
Done.
</code></pre>
<pre class="language-"><code>&#x279C; rpc tree
.
&#x251C;&#x2500;&#x2500; common
&#x2502;  &#x2514;&#x2500;&#x2500; common.pb.go
&#x251C;&#x2500;&#x2500; common.go
&#x251C;&#x2500;&#x2500; common.proto
&#x251C;&#x2500;&#x2500; commonclient
&#x2502;  &#x2514;&#x2500;&#x2500; common.go
&#x251C;&#x2500;&#x2500; etc
&#x2502;  &#x2514;&#x2500;&#x2500; common.yaml
&#x2514;&#x2500;&#x2500; internal
&#x251C;&#x2500;&#x2500; config
&#x2502;  &#x2514;&#x2500;&#x2500; config.go
&#x251C;&#x2500;&#x2500; logic
&#x2502;  &#x251C;&#x2500;&#x2500; getappconfiglogic.go
&#x2502;  &#x2514;&#x2500;&#x2500; getbaseapplogic.go
&#x251C;&#x2500;&#x2500; server
&#x2502;  &#x2514;&#x2500;&#x2500; commonserver.go
&#x2514;&#x2500;&#x2500; svc
&#x2514;&#x2500;&#x2500; servicecontext.go

8 directories, 10 files
</code></pre><p>Basically, all the catalog specifications and structure are generated, so there is no need to worry about the project catalog, how to put it, and how to organize it.</p>
<p>Take a look at the configuration information, which can write mysql and other redis information:</p>
<pre class="language-"><code class="lang-yaml"><span class="token key atrule">Name</span><span class="token punctuation">:</span> common.rpc
<span class="token key atrule">ListenOn</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8081</span>
<span class="token key atrule">Mysql</span><span class="token punctuation">:</span>
  <span class="token key atrule">DataSource</span><span class="token punctuation">:</span> root<span class="token punctuation">:</span>admin@tcp(127.0.0.1<span class="token punctuation">:</span>3306)/datacenter<span class="token punctuation">?</span>charset=utf8<span class="token important">&amp;parseTime=true&amp;loc=Asia%2FShanghai</span>
<span class="token key atrule">CacheRedis</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">Host</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">6379</span>
  <span class="token key atrule">Pass</span><span class="token punctuation">:</span>
  <span class="token key atrule">Type</span><span class="token punctuation">:</span> node  
<span class="token key atrule">Etcd</span><span class="token punctuation">:</span>
  <span class="token key atrule">Hosts</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">2379</span>
  <span class="token key atrule">Key</span><span class="token punctuation">:</span> common.rpc
</code></pre>
<p>Let&apos;s add database services:</p>
<pre class="language-"><code>&#x279C;  rpc cd ..
&#x279C;  common ls
rpc
&#x279C;  common pwd
/Users/jackluo/works/blogs/datacenter/common
&#x279C;  common goctl model mysql datasource -url=&quot;root:admin@tcp(127.0.0.1:3306)/datacenter&quot; -table=&quot;base_app&quot; -dir ./model -c
Done.
&#x279C;  common tree
.
&#x251C;&#x2500;&#x2500; model
&#x2502;   &#x251C;&#x2500;&#x2500; baseappmodel.go
&#x2502;   &#x2514;&#x2500;&#x2500; vars.go
&#x2514;&#x2500;&#x2500; rpc
    &#x251C;&#x2500;&#x2500; common
    &#x2502;   &#x2514;&#x2500;&#x2500; common.pb.go
    &#x251C;&#x2500;&#x2500; common.go
    &#x251C;&#x2500;&#x2500; common.proto
    &#x251C;&#x2500;&#x2500; commonclient
    &#x2502;   &#x2514;&#x2500;&#x2500; common.go
    &#x251C;&#x2500;&#x2500; etc
    &#x2502;   &#x2514;&#x2500;&#x2500; common.yaml
    &#x2514;&#x2500;&#x2500; internal
        &#x251C;&#x2500;&#x2500; config
        &#x2502;   &#x2514;&#x2500;&#x2500; config.go
        &#x251C;&#x2500;&#x2500; logic
        &#x2502;   &#x251C;&#x2500;&#x2500; getappconfiglogic.go
        &#x2502;   &#x2514;&#x2500;&#x2500; getbaseapplogic.go
        &#x251C;&#x2500;&#x2500; server
        &#x2502;   &#x2514;&#x2500;&#x2500; commonserver.go
        &#x2514;&#x2500;&#x2500; svc
            &#x2514;&#x2500;&#x2500; servicecontext.go

10 directories, 12 files
</code></pre><p>So the basic <code>rpc</code> is finished, and then we connect the rpc with the model and the api. This official document is already very detailed, here is just the code:</p>
<pre class="language-"><code class="lang-go">&#x279C;  common cat rpc<span class="token operator">/</span>internal<span class="token operator">/</span>config<span class="token operator">/</span>config<span class="token punctuation">.</span><span class="token keyword">go</span>
<span class="token keyword">package</span> config

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/core/stores/cache&quot;</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/zrpc&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    zrpc<span class="token punctuation">.</span>RpcServerConf
    Mysql <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        DataSource <span class="token builtin">string</span>
    <span class="token punctuation">}</span>
    CacheRedis cache<span class="token punctuation">.</span>ClusterConf
<span class="token punctuation">}</span>
</code></pre>
<p>Modify in svc&#xFF1A;</p>
<pre class="language-"><code class="lang-go">&#x279C;  common cat rpc<span class="token operator">/</span>internal<span class="token operator">/</span>svc<span class="token operator">/</span>servicecontext<span class="token punctuation">.</span><span class="token keyword">go</span>
<span class="token keyword">package</span> svc

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;datacenter/common/model&quot;</span>
    <span class="token string">&quot;datacenter/common/rpc/internal/config&quot;</span>

    <span class="token string">&quot;github.com/tal-tech/go-zero/core/stores/sqlx&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> ServiceContext <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    c              config<span class="token punctuation">.</span>Config
    AppConfigModel model<span class="token punctuation">.</span>AppConfigModel
    BaseAppModel   model<span class="token punctuation">.</span>BaseAppModel
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewServiceContext</span><span class="token punctuation">(</span>c config<span class="token punctuation">.</span>Config<span class="token punctuation">)</span> <span class="token operator">*</span>ServiceContext <span class="token punctuation">{</span>
    conn <span class="token operator">:=</span> sqlx<span class="token punctuation">.</span><span class="token function">NewMysql</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>Mysql<span class="token punctuation">.</span>DataSource<span class="token punctuation">)</span>
    apm <span class="token operator">:=</span> model<span class="token punctuation">.</span><span class="token function">NewAppConfigModel</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> c<span class="token punctuation">.</span>CacheRedis<span class="token punctuation">)</span>
    bam <span class="token operator">:=</span> model<span class="token punctuation">.</span><span class="token function">NewBaseAppModel</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> c<span class="token punctuation">.</span>CacheRedis<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>ServiceContext<span class="token punctuation">{</span>
        c<span class="token punctuation">:</span>              c<span class="token punctuation">,</span>
        AppConfigModel<span class="token punctuation">:</span> apm<span class="token punctuation">,</span>
        BaseAppModel<span class="token punctuation">:</span>   bam<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The above code has already associated <code>rpc</code> with the <code>model</code> database, we will now associate <code>rpc</code> with <code>api</code>:</p>
<pre class="language-"><code class="lang-go">&#x279C;  datacenter cat internal<span class="token operator">/</span>config<span class="token operator">/</span>config<span class="token punctuation">.</span><span class="token keyword">go</span>

<span class="token keyword">package</span> config

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/core/stores/cache&quot;</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/rest&quot;</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/zrpc&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    rest<span class="token punctuation">.</span>RestConf

    Auth <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        AccessSecret <span class="token builtin">string</span>
        AccessExpire <span class="token builtin">int64</span>
    <span class="token punctuation">}</span>
    UserRpc   zrpc<span class="token punctuation">.</span>RpcClientConf
    CommonRpc zrpc<span class="token punctuation">.</span>RpcClientConf
    VotesRpc  zrpc<span class="token punctuation">.</span>RpcClientConf

    CacheRedis cache<span class="token punctuation">.</span>ClusterConf
<span class="token punctuation">}</span>
</code></pre>
<p>Join the <code>svc</code> service&#xFF1A;</p>
<pre class="language-"><code class="lang-go">&#x279C;  datacenter cat internal<span class="token operator">/</span>svc<span class="token operator">/</span>servicecontext<span class="token punctuation">.</span><span class="token keyword">go</span>
<span class="token keyword">package</span> svc

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;context&quot;</span>
    <span class="token string">&quot;datacenter/common/rpc/commonclient&quot;</span>
    <span class="token string">&quot;datacenter/internal/config&quot;</span>
    <span class="token string">&quot;datacenter/internal/middleware&quot;</span>
    <span class="token string">&quot;datacenter/shared&quot;</span>
    <span class="token string">&quot;datacenter/user/rpc/userclient&quot;</span>
    <span class="token string">&quot;datacenter/votes/rpc/votesclient&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;net/http&quot;</span>
    <span class="token string">&quot;time&quot;</span>

    <span class="token string">&quot;github.com/tal-tech/go-zero/core/logx&quot;</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/core/stores/cache&quot;</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/core/stores/redis&quot;</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/core/syncx&quot;</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/rest&quot;</span>
    <span class="token string">&quot;github.com/tal-tech/go-zero/zrpc&quot;</span>
    <span class="token string">&quot;google.golang.org/grpc&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> ServiceContext <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Config           config<span class="token punctuation">.</span>Config
    GreetMiddleware1 rest<span class="token punctuation">.</span>Middleware
    GreetMiddleware2 rest<span class="token punctuation">.</span>Middleware
    Usercheck        rest<span class="token punctuation">.</span>Middleware
    UserRpc          userclient<span class="token punctuation">.</span>User <span class="token comment">//&#x7528;&#x6237;</span>
    CommonRpc        commonclient<span class="token punctuation">.</span>Common
    VotesRpc         votesclient<span class="token punctuation">.</span>Votes
    Cache            cache<span class="token punctuation">.</span>Cache
    RedisConn        <span class="token operator">*</span>redis<span class="token punctuation">.</span>Redis
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">timeInterceptor</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> method <span class="token builtin">string</span><span class="token punctuation">,</span> req<span class="token punctuation">,</span> reply <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cc <span class="token operator">*</span>grpc<span class="token punctuation">.</span>ClientConn<span class="token punctuation">,</span> invoker grpc<span class="token punctuation">.</span>UnaryInvoker<span class="token punctuation">,</span> opts <span class="token operator">...</span>grpc<span class="token punctuation">.</span>CallOption<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    stime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    err <span class="token operator">:=</span> <span class="token function">invoker</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> method<span class="token punctuation">,</span> req<span class="token punctuation">,</span> reply<span class="token punctuation">,</span> cc<span class="token punctuation">,</span> opts<span class="token operator">...</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> err
    <span class="token punctuation">}</span>

    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;timeout %s: %v\n&quot;</span><span class="token punctuation">,</span> method<span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>stime<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">NewServiceContext</span><span class="token punctuation">(</span>c config<span class="token punctuation">.</span>Config<span class="token punctuation">)</span> <span class="token operator">*</span>ServiceContext <span class="token punctuation">{</span>

    ur <span class="token operator">:=</span> userclient<span class="token punctuation">.</span><span class="token function">NewUser</span><span class="token punctuation">(</span>zrpc<span class="token punctuation">.</span><span class="token function">MustNewClient</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>UserRpc<span class="token punctuation">,</span> zrpc<span class="token punctuation">.</span><span class="token function">WithUnaryClientInterceptor</span><span class="token punctuation">(</span>timeInterceptor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cr <span class="token operator">:=</span> commonclient<span class="token punctuation">.</span><span class="token function">NewCommon</span><span class="token punctuation">(</span>zrpc<span class="token punctuation">.</span><span class="token function">MustNewClient</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>CommonRpc<span class="token punctuation">,</span> zrpc<span class="token punctuation">.</span><span class="token function">WithUnaryClientInterceptor</span><span class="token punctuation">(</span>timeInterceptor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    vr <span class="token operator">:=</span> votesclient<span class="token punctuation">.</span><span class="token function">NewVotes</span><span class="token punctuation">(</span>zrpc<span class="token punctuation">.</span><span class="token function">MustNewClient</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>VotesRpc<span class="token punctuation">,</span> zrpc<span class="token punctuation">.</span><span class="token function">WithUnaryClientInterceptor</span><span class="token punctuation">(</span>timeInterceptor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">//&#x7F13;&#x5B58;</span>
    ca <span class="token operator">:=</span> cache<span class="token punctuation">.</span><span class="token function">NewCache</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>CacheRedis<span class="token punctuation">,</span> syncx<span class="token punctuation">.</span><span class="token function">NewSharedCalls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cache<span class="token punctuation">.</span><span class="token function">NewCacheStat</span><span class="token punctuation">(</span><span class="token string">&quot;dc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> shared<span class="token punctuation">.</span>ErrNotFound<span class="token punctuation">)</span>
    rcon <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">NewRedis</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>CacheRedis<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Host<span class="token punctuation">,</span> c<span class="token punctuation">.</span>CacheRedis<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Type<span class="token punctuation">,</span> c<span class="token punctuation">.</span>CacheRedis<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Pass<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>ServiceContext<span class="token punctuation">{</span>
        Config<span class="token punctuation">:</span>           c<span class="token punctuation">,</span>
        GreetMiddleware1<span class="token punctuation">:</span> greetMiddleware1<span class="token punctuation">,</span>
        GreetMiddleware2<span class="token punctuation">:</span> greetMiddleware2<span class="token punctuation">,</span>
        Usercheck<span class="token punctuation">:</span>        middleware<span class="token punctuation">.</span><span class="token function">NewUserCheckMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Handle<span class="token punctuation">,</span>
        UserRpc<span class="token punctuation">:</span>          ur<span class="token punctuation">,</span>
        CommonRpc<span class="token punctuation">:</span>        cr<span class="token punctuation">,</span>
        VotesRpc<span class="token punctuation">:</span>         vr<span class="token punctuation">,</span>
        Cache<span class="token punctuation">:</span>            ca<span class="token punctuation">,</span>
        RedisConn<span class="token punctuation">:</span>        rcon<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Basically, we can call it in the file directory of <code>logic</code>:</p>
<pre class="language-"><code class="lang-go">cat internal<span class="token operator">/</span>logic<span class="token operator">/</span>common<span class="token operator">/</span>appinfologic<span class="token punctuation">.</span><span class="token keyword">go</span>

<span class="token keyword">package</span> logic

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;context&quot;</span>

    <span class="token string">&quot;datacenter/internal/svc&quot;</span>
    <span class="token string">&quot;datacenter/internal/types&quot;</span>
    <span class="token string">&quot;datacenter/shared&quot;</span>

    <span class="token string">&quot;datacenter/common/model&quot;</span>
    <span class="token string">&quot;datacenter/common/rpc/common&quot;</span>

    <span class="token string">&quot;github.com/tal-tech/go-zero/core/logx&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> AppInfoLogic <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    logx<span class="token punctuation">.</span>Logger
    ctx    context<span class="token punctuation">.</span>Context
    svcCtx <span class="token operator">*</span>svc<span class="token punctuation">.</span>ServiceContext
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewAppInfoLogic</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> svcCtx <span class="token operator">*</span>svc<span class="token punctuation">.</span>ServiceContext<span class="token punctuation">)</span> AppInfoLogic <span class="token punctuation">{</span>
    <span class="token keyword">return</span> AppInfoLogic<span class="token punctuation">{</span>
        Logger<span class="token punctuation">:</span> logx<span class="token punctuation">.</span><span class="token function">WithContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">,</span>
        ctx<span class="token punctuation">:</span>    ctx<span class="token punctuation">,</span>
        svcCtx<span class="token punctuation">:</span> svcCtx<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>AppInfoLogic<span class="token punctuation">)</span> <span class="token function">AppInfo</span><span class="token punctuation">(</span>req types<span class="token punctuation">.</span>Beid<span class="token punctuation">)</span> <span class="token punctuation">(</span>appconfig <span class="token operator">*</span>common<span class="token punctuation">.</span>BaseAppResp<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    err <span class="token operator">=</span> l<span class="token punctuation">.</span>svcCtx<span class="token punctuation">.</span>Cache<span class="token punctuation">.</span><span class="token function">GetCache</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">GetcacheBaseAppIdPrefix</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Beid<span class="token punctuation">)</span><span class="token punctuation">,</span> appconfig<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> err <span class="token operator">==</span> shared<span class="token punctuation">.</span>ErrNotFound <span class="token punctuation">{</span>
        appconfig<span class="token punctuation">,</span> err <span class="token operator">=</span> l<span class="token punctuation">.</span>svcCtx<span class="token punctuation">.</span>CommonRpc<span class="token punctuation">.</span><span class="token function">GetBaseApp</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>common<span class="token punctuation">.</span>BaseAppReq<span class="token punctuation">{</span>
            Beid<span class="token punctuation">:</span> req<span class="token punctuation">.</span>Beid<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        err <span class="token operator">=</span> l<span class="token punctuation">.</span>svcCtx<span class="token punctuation">.</span>Cache<span class="token punctuation">.</span><span class="token function">SetCache</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">GetcacheBaseAppIdPrefix</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Beid<span class="token punctuation">)</span><span class="token punctuation">,</span> appconfig<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
<p>In this way, it is basically connected, and basically there is no need to change the others. <code>UserRPC</code> and <code>VotesRPC</code> are similar, so I won&apos;t write them here.</p>
<h2 id="reviews">Reviews</h2>
<p><code>go-zero</code> is really fragrant, because it has a <code>goctl</code> tool, which can automatically generate all the code structure, we will no longer worry about the directory structure, how to organize it, and there is no architectural ability for several years It&#x2019;s not easy to implement. What are the norms, concurrency, circuit breaker, no use at all, test and filter other, concentrate on realizing the business, like microservices, but also service discovery, a series of things, don&#x2019;t care, because <code>go-zero</code> has been implemented internally.</p>
<p>I have written code for more than 10 years. The php I have been using before, the more famous ones are laravel and thinkphp, which are basically modular. Realizations like microservices are really costly, but you use go-zero. , You develop as simple as tune api interface, other service discovery, those do not need to pay attention at all, only need to pay attention to the business.</p>
<p>A good language, framework, and their underlying thinking are always high-efficiency and no overtime thinking. I believe that go-zero will improve the efficiency of you and your team or company. The author of go-zero said that they have a team dedicated to organizing the go-zero framework, and the purpose should be obvious, that is, to improve their own development efficiency, process flow, and standardization, which are the criteria for improving work efficiency, as we usually encounter When it comes to a problem or encounter a bug, the first thing I think of is not how to solve my bug, but whether there is a problem with my process, which of my process will cause the bug, and finally I believe in <code>go-zero</code>Can become the preferred framework for <strong>microservice development</strong>.</p>
<p>Finally, talk about the pits encountered:</p>
<ul>
<li><code>grpc</code></li>
</ul>
<p>I used <code>grpc</code> for the first time, and then I encountered the problem that the field value is not displayed when some characters are empty:</p>
<p>It is realized by <code>jsonpb</code> in the official library of <code>grpc</code>. The official setting has a structure to realize the conversion of <code>protoc buffer</code> to JSON structure, and can configure the conversion requirements according to the fields.</p>
<ul>
<li>Cross-domain issues</li>
</ul>
<p>It is set in <code>go-zero</code>, and it feels no effect. The big guy said that it was set through nginx, but later found that it still didn&apos;t work. Recently, I forcibly got a domain name, and I have time to solve it later.</p>
<ul>
<li><code>sqlx</code></li>
</ul>
<p>The <code>sqlx</code> problem of <code>go-zero</code>, this really took a long time:</p>
<blockquote>
<p><code>time.Time</code> is a data structure. Timestamp is used in the database. For example, my field is delete_at. The default database setting is null. When the result is inserted, it reports <code>Incorrect datetime value: &apos;0000-00-00 &apos;for column&apos;deleted_at&apos; at row 1&quot;}</code> This error, the query time reported <code>deleted_at\&quot;: unsupported Scan, storing driver.Value type \u003cnil\u003e into type *time.Time&quot;</code></p>
<p>I removed this field decisively and added the label <code>.omitempty</code> above the field, which seems to be useful too, <code>db:&quot;.omitempty&quot;</code></p>
</blockquote>
<p>The second is this <code>Conversion from collation utf8_general_ci into utf8mb4_unicode_ci</code>. The probable reason for this is that I like to use emj expressions now, and my mysql data cannot be recognized.</p>
<ul>
<li>data links</li>
</ul>
<p><code>mysql</code> still follows the original way, modify the encoding format of the configuration file, re-create the database, and set the database encoding to utf8mb4, and the sorting rule is <code>utf8mb4_unicode_ci</code>.</p>
<p><strong>In this case, all tables and string fields are in this encoding format. If you don&apos;t want all of them, you can set them separately. This is not the point. Because it is easy to set on Navicat, just click manually</strong>&#x3002;</p>
<p>Here comes the important point: Golang uses the <code>github.com/go-sql-driver/mysql</code> driver, which will connect to the <code>dsn</code> of <code>mysql</code> (because I am using gorm, dsn may be different from the native format. Too the same, but it&#x2019;s okay, just pay attention to <code>charset</code> and <code>collation</code>)
<code>root:password@/name?parseTime=True&amp;loc=Local&amp;charset=utf8</code> is modified to:
<code>root:password@/name?parseTime=True&amp;loc=Local&amp;charset=utf8mb4&amp;collation=utf8mb4_unicode_ci</code></p>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; 2019-2021 go-zero all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">Last UpdateTime&#xFF1A;
2021-07-08 02:04:06
</span></footer>
<script>console.log("plugin-popup....");document.onclick = function(e){ e.target.tagName === "IMG" && window.open(e.target.src,e.target.src)}</script><style>img{cursor:pointer}</style>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="go-queue.html" class="navigation navigation-prev " aria-label="Previous page: Queue">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="stream.html" class="navigation navigation-next " aria-label="Next page: Stream Handler">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Middle Ground System","level":"1.13.4","depth":2,"next":{"title":"Stream Handler","level":"1.13.5","depth":2,"path":"stream.md","ref":"stream.md","articles":[]},"previous":{"title":"Queue","level":"1.13.3","depth":2,"path":"go-queue.md","ref":"go-queue.md","articles":[]},"dir":"ltr"},"config":{"plugins":["back-to-top-button","chapter-fold","code","-lunr","-search","search-pro","github","splitter","-sharing","sharing-plus","tbfed-pagefooter","flexible-alerts","page-toc-button","pageview-count","popup","hide-element","edit-link","-highlight","prism","theme-comscore"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright Â© 2019-2021 go-zero","modify_label":"Last UpdateTimeï¼","modify_format":"YYYY-MM-DD HH:mm:ss"},"chapter-fold":{},"prism":{"lang":{"shell":"bash"},"css":["prismjs/themes/prism-tomorrow.css"]},"github":{"url":"https://github.com/tal-tech/go-zero"},"splitter":{},"search-pro":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"popup":{},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-comscore":{},"page-toc-button":{"maxTocDepth":2,"minTocSize":2},"back-to-top-button":{},"pageview-count":{},"flexible-alerts":{"danger":{"className":"danger","icon":"fa fa-ban","label":"Attention"},"note":{"className":"info","icon":"fa fa-info-circle","label":"Note"},"style":"callout","tip":{"className":"tip","icon":"fa fa-lightbulb-o","label":"Tip"},"warning":{"className":"warning","icon":"fa fa-exclamation-triangle","label":"Warning"}},"sharing":{"qq":false,"all":["douban","facebook","google","linkedin","twitter","weibo","qq","qzone","weibo"],"douban":false,"facebook":false,"weibo":true,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":false,"messenger":false,"line":true,"vk":false,"pocket":false,"google":true,"viber":false,"stumbleupon":false,"qzone":true,"linkedin":true},"edit-link":{"label":"EDIT THIS PAGE","base":"https://github.com/zeromicro/go-zero-doc/blob/master"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"anqiansong","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"go-zero document","language":"en","gitbook":"*","description":"Golang å¾®æå¡æ¡æ¶ | éæåç§å·¥ç¨å®è·µç WEB å RPC æ¡æ¶ | ä¸é®çæ Go, iOS, Android, Kotlin, Dart, TypeScript, JavaScript ä»£ç "},"file":{"path":"datacenter.md","mtime":"2021-07-08T02:04:06.679Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-07-08T02:05:12.932Z"},"basePath":".","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-flexible-alerts/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

